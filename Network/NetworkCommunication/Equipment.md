# 네트워크 장비

# Cable 
케이블은 크게 3종류로 구분된다.
1. Crossover Cable[cross]

2. Straight-Through Cable[direct]

3. Lollover Cable[Console]

> 다이렉트 케이블은 같은 계층에 있는 장비끼리 연결할때, 크로스케이블은 서로 다른 계층에 있는 장비를 연결할때 사용된다. 

# L1
## Hub
데이터와 신호에 대한 변환만 가능하다. 
허브는 패킷이 들어온 포트를 제외하고 모든 포트로 패킷 전달.
연결된 PC수가 많아질수록 네트워크에서 충돌이 많아져 속도가 느려진다.

# L2 
## Switch 
- 브릿지와 스위치는 MAC 주소와 해당 장비의 포트 번호가 기록된 MAC address table을 보고 목적지에게만 Frame 전송.
- 스위치는 한 포트에서 전송되느느 Frame이 MAC address table  에 있는 특정 포트로만 전송하기에 다른 포트가 전송하는 Frame과 충돌 발생하지 않음
- 스위치는 각각의 포트가 하나의 Collision domain에 있다고 표현.
## 1. 스위치
### 1.1 개념
누가 어느 위치에 있는지 파악하고 실제 통신시 자신이 알고있는 위치로 패킷을 정확하게 전송하는 것.
=> MAC주소 테이블을 가지고 있기에 가능
### 1.2 동작 
스위치 부팅 시 네트워크 관련 정도가 아무 것도 없다. 
- 플러딩(Flooding)
```
Hub같이 모든 포트로 패킷을 흘리는 동작.

패킷을 전달 받으면 도착지 MAC주소를 파악하여 스위치의 MAC 주소 테이블에 있는 곳으로 전송을 한다.
MAC 주소 테이블에 해당 MAC주소가 없을 경우 모든 포트에 같은 내용의 패킷을 전송함. 

why? 스위치는 LAN 환경에서 구성되기 때문에 자신이 정보를 갖고 있지 않더라도 어딘가에 장비가 있을수 있다고 가정하기때문.

플러딩은 정상적인 동작이지만 플러딩이 많아지면 스위치가 정상적인 작동을 못한다.
```
> 비정상적 플러딩 : 
- 어드레스러닝(Address Learning)

```
스위치가 정상적으로 동작하려면 MAC주소 테이블이 유지되어야함.
따라서, MAC주소 테이블을 만들고 유지하는 과정을 Address Learning 이라한다.


```
>  MAC 주소 테이블 : 어느 위치(포트)에 어떤 장비(MAC 주소)가 연결되었는지에 대한 정보가 저장된 임시 테이블. 
- 포워딩/필터링(Forwarding/Filtering)
```
포워딩 : 패킷이 들어왔을 경우 도착지 MAC주소를 확인하고 MAC 주소테이블과 비교하여 해당 포트로 패킷을 넘기는것을 포워딩이라한다.

필터링 : 다른 포트로 해당 패킷을 보내지 않는것을 필터링이라 한다.

포워딩과 필터링 작업은 여러 포트에서 동시에 수행 될수있다.
통신은 다른 포트에 영향을 미치지 않기에 독립적으로 동작한다. 
```

- 에이징(Aging)
```
ARP 테이블과 MAC테이블은 일정한 시간동안 지워지지 않는다
-> 이 시간을 에이징 타임 이라한다.

일반적으로 MAC 테이블의 에이징 타임이 단말의 ARP 에이징 타임보다 길기때문에 네트워크를 플러딩없이 운영가능.
```


---
패킷을 만들기 전에 통신 단말간에 MAC주소를 알아 내기 위해 ARP브로드캐스트가 먼저 수행 되기때문에 유니캐스트보다 ARP브로드캐스트가 먼저 네트워크에 전달 
-> 이 ARP를 이용한 MAC 주소 습득돠정에서 이미 출발/목적지의 MAC주소를 습득할수있어 실제 유니캐스트 통신 시작시 이미 만들어진 MAC 테이블로 포워딩/필터링한다.
# L3
## 1. 라우터

목적지의 주소가 라우팅 테이블에 존재 하지않을 경우 패킷을 버림.

### 1. 1라우터 동작
#### 1.1.1 경로 지정 - 라우팅/스위칭
라우터가 패킷을 처리 할때 크게 2가지 작업을 수행함.
- 경로 정보를 얻어 경로 정보를 정리
- 정리된 경로 정보를 기반으로 패킷을 포워딩.

#### 1.1.2 라우팅 동작과 라우팅 테이블
현대 인터넷에서는 단말의 목적지까지 경로를 모두 책임 지는것이 아니다.
홉-바이-홉(Hop-by-Hop): 인접한 라우터까지만 경로를 지정하고 인접한 라우터에서 다시 최적의 경로를 파악후 패킷을 포워딩한다. 

인접한 라우터를 넥스트 홉(Next Hop)이라 부른다.
-> 라우터는 최적의 넥스트 홉을 선택해 전송
```
넥스트 홉 지정 방법
1. 다음 라우터의 IP를 지정하는 방법
2. 라우터의 나가는 인터페이스를 지정하는 방법
3. 라우터의 나가는 인터페이스와 다음 라우터의 IP를 동시에 지정하는 법
```
> 루프가 없는 3계층 : TTL(Time To Live) : TTL은 패킷이 네트워크에 살아있을수 있는 시간을 제한합니다. 
> 라우터(홉)을 지날때마다 TTL 값이 1씩 감소한다. 0이 되면 패킷은 소멸된다. 따라서 패킷이 무한히 네트워크에 루프되는것을 막는다.

#### 1.1.2Routing (경로 정보를 얻는 법)
1. static routing : 관리자가 목적지 네트워크와 넥스트 홉을 라우터에 직접 지정해 경로 정보를 입력하는 것.
2. 
```
cisco : ip route NETWORK SUBNETMASK NEXTHOP
route add -net NETWORK /Prefix gw NEXTHOP
```
3. dynamic route : 라우터가 프로세스에 의해 서로 주고받아 네트워크 정보를 동기화함.


### 라우터 IP 주소 할당
```linux
Router> en // 관리자 모드로 전환
Router# conf t 
Router(config)# hostname GW // 이름변경
GW(config)# int fa 0/0 
GW(config-if)# ip address 0.0.0.0 255.255.255.255 // IP와 서브넷마스크 할당
GW(config-if)# no shutdown // shotdown이 기본설정인데 이걸 해제 -> 라우터 켜짐
GW(config-if)#end // 빠져나옴
GW# show run // 입력한 명령어 확인
GW# wr //저장
GW# ping 192.168.0.1~ // end device 까지 핑테스트
GW# show ip int brief // 인터페이스 확인
GW# show ip route // 라우팅 테이블 확인
```